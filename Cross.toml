[build]
# Disable sccache for cross-compilation

# Override linker settings from .cargo/config.toml for cross-compilation
[target.aarch64-unknown-linux-gnu]
pre-build = [
    "apt-get update && apt-get install -y curl unzip",
    "curl -LO https://github.com/protocolbuffers/protobuf/releases/download/v25.1/protoc-25.1-linux-x86_64.zip",
    "unzip -o protoc-25.1-linux-x86_64.zip -d /usr/local",
    "chmod +x /usr/local/bin/protoc",
    "rm protoc-25.1-linux-x86_64.zip",
    "protoc"
]

[target.aarch64-unknown-linux-gnu.env]
# Add pnpm to PATH for build scripts that might need it
passthrough = ["PATH"]

[env]
# Set PROTOC to be available in Docker container after downloading it
PROTOC = "/usr/local/bin/protoc"
